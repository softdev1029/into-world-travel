!function(a,b,c){"use strict";function d(b,c,e){var f,g=e||new Date;return g.isTW=!0,g.weekdays=function(a){var b,c,d=moment.weekdaysShort();for(b=d.splice(1),b[6]=d[0],d=b,b=d.splice(a-1),c=0;a-1>c;c+=1)b.push(d[c]);return b},g.clone=function(a,b,c,e,f,h){var i=new d(!1,!1,new Date(g.getTime()));return e&&i.setHours(e),f&&i.setMinutes(f),h&&i.setSeconds(h),a&&i.setFullYear(a),b&&i.setMonth(b),c&&i.setDate(c),i},g.inRange=function(a,b){return moment(a).isBetween(b[0],b[1],"day")||moment(a).isSame(b[0],"day")||moment(a).isSame(b[1],"day")},g.isValid=function(){return"[object Date]"!==Object.prototype.toString.call(g)?!1:!isNaN(g.getTime())},g.parseStr=function(b,c){var e="string"===a.type(b)?moment(b,c):b;return e&&e.isValid()?g=e.isTW?e:new d(0,0,e.toDate()):null},g.isEqualDate=function(a,b){return a&&a.isValid()&&b&&b.isValid()?a.getDate()===b.getDate()&&a.getMonth()===b.getMonth()&&a.getMonth()===b.getMonth():!1},g.format=function(a){return f=moment(g).format(a),new RegExp("^[0-9]+$").test(f)?parseInt(f,10):f},g.countDaysInMonth=function(){return new Date(g.getFullYear(),g.getMonth()+1,0).getDate()},b&&c&&g.parseStr(b,c),g}function e(b,c){var e,f,h=this,i=new d;h.options=c,h.picker=a('<div unselectable="on" class="period_picker_box xdsoft_noselect" style=""><div class="period_picker_resizer"></div><div class="period_picker_head"><span class="period_picker_head_title"></span><span class="period_picker_max_min" title="'+this.i18n("Open fullscreen")+'"></span><span class="period_picker_close" title="'+this.i18n("Close")+'"></span></div><div class="period_picker_years"><div class="period_picker_years_inner"><div class="period_picker_years_selector"><div class="period_picker_years_selector_container" style="width: 5960px; left: 0px;"></div></div></div></div><div class="period_picker_work"><a href="" class="xdsoft_navigate xdsoft_navigate_prev"></a><div class="period_picker_timepicker_box"><input data-index="0" class="timepicker" type="hidden"></div><div class="period_picker_days"><table><tbody></tbody></table></div><div class="period_picker_timepicker_box"><input  data-index="1"  class="timepicker" type="hidden"></div><a href="" class="xdsoft_navigate xdsoft_navigate_next"></a></div><div class="period_picker_submit_shadow"></div><div class="period_picker_submit_dates"><span class="period_picker_from_time_block period_picker_time"><span class="input_box"><input data-index="0"  class="input_control period_picker_from_time"></span></span><span class="period_picker_from_block period_picker_date"><span class="input_box"><input class="input_control period_picker_from" maxlength="10"></span></span><span class="period_picker_date_separator">&#8212;</span><span class="period_picker_to_block period_picker_date"><span class="input_box"><input class="input_control period_picker_to" maxlength="10"></span></span><span class="period_picker_to_time_block period_picker_time"><span class="input_box"><input data-index="1" class="input_control period_picker_to_time"></span></span><button class="period_picker_show period_picker_ok" role="button" type="button"><span class="button_text">'+this.i18n("OK")+'</span></button><button class="period_picker_show period_picker_clear" role="button" type="button"><span class="button_text">'+this.i18n("Clear")+"</span></button></div></div>"),h.pickerdays=h.picker.find(".period_picker_days"),h.calendarbox=h.pickerdays.find("> table > tbody"),h.yearsline=h.picker.find(".period_picker_years_selector_container"),h.yearslineparent=h.picker.find(".period_picker_years_selector"),h.timepicker=h.picker.find(".period_picker_timepicker_box"),h.button=a('<div class="period_picker_input" type="button"><span class="period_button_text"><span class="period_button_content_wrapper"><span class="period_button_content"><span class="icon_calendar"></span><span class="period_button_content_body">'+this.i18n(c.norange?"Choose date":"Choose period")+'</span><span class="icon_clear"></span></span></span></span></div>'),h.startinput=a(c.start?c.start:b),h.endinput=a(c.end),h.startinput.attr("autocomplete","off"),h.endinput.attr("autocomplete","off"),h.periodtime=[[]],h.period=[[]],h.director=0,e=new d,h.addRange([e.parseStr(h.startinput.val(),c.timepicker?c.formatDateTime:c.formatDate)||e.parseStr(h.startinput.val(),c.formatDate),e.parseStr(h.endinput.val(),c.timepicker?c.formatDateTime:c.formatDate)||e.parseStr(h.endinput.val(),c.formatDate)]),h.onAfterShow=[],h.onAfterHide=[],h.onAfterRegenerate=[],h.uniqueid=g,h.timer1=0,h.timer2=0,h.timer3=0,g+=1,h.applyOptions(),h.init(),c.timepicker&&void 0!==a.fn.TimePicker&&(c.useTimepickerLimits&&(f=h.timepicker.find("input.timepicker"),i.isEqualDate(h.period[0],h.period[1])&&(f.eq(0).TimePicker("setValue",h.period[0]).TimePicker("setMax",h.period[1]),f.eq(1).TimePicker("setValue",h.period[1]).TimePicker("setMin",h.period[0]))),h.addRangeTime(h.period[0],h.period[1]))}var f,g=0;e.prototype.applyOptions=function(){var b,c=this.options,e=this,f=function(a,b){(b||void 0===b)&&a.is(":hidden")?a.each(function(){this.style.display=""}):b||a.hide()};e.picker.toggleClass("period_picker_maximize",c.fullsize),f(e.picker.find(".period_picker_resizer"),c.resizeButton),f(e.picker.find(".period_picker_head_title").html(e.i18n(c.norange?"Select date":"Select period")),c.title),f(e.picker.find(".period_picker_max_min"),c.fullsizeButton),f(e.picker.find(".period_picker_close"),c.closeButton&&!c.inline),f(e.picker.find(".period_picker_years"),c.yearsLine),f(e.picker.find(".xdsoft_navigate"),c.navigate),f(e.picker.find(".period_picker_timepicker_box").eq(0),c.timepicker&&void 0!==a.fn.TimePicker),f(e.picker.find(".period_picker_timepicker_box").eq(1),c.timepicker&&void 0!==a.fn.TimePicker&&!c.norange),e.picker.find(".period_picker_date,.period_picker_date_separator").css("visibility",c.showDatepickerInputs?"":"hidden"),f(e.picker.find(".period_picker_from_time_block"),c.timepicker&&void 0!==a.fn.TimePicker),e.picker.find(".period_picker_from_time_block").css("visibility",c.showTimepickerInputs?"":"hidden"),f(e.picker.find(".period_picker_to_time_block"),c.timepicker&&void 0!==a.fn.TimePicker&&!e.options.norange),e.picker.find(".period_picker_to_time_block").css("visibility",c.showTimepickerInputs?"":"hidden"),f(e.picker.find(".period_picker_ok"),c.okButton&&!c.inline),f(e.picker.find(".period_picker_clear"),c.clearButton),f(e.button.find(".period_button_content .icon_clear"),c.clearButtonInButton),!c.withoutBottomPanel&&(c.clearButton||c.okButton&&!c.inline||c.showDatepickerInputs||c.showTimepickerInputs&&c.timepicker&&void 0!==a.fn.TimePicker)||(e.picker.addClass("without_bottom_panel"),c.withoutBottomPanel=!0,c.someYOffset=0),c.yearsLine||e.picker.addClass("without_yearsline"),c.title||c.fullsizeButton||c.closeButton&&!c.inline||e.picker.addClass("without_header"),c.timepicker&&void 0!==a.fn.TimePicker&&e.picker.addClass("with_first_timepicker"),c.timepicker&&void 0!==a.fn.TimePicker&&!c.norange&&e.picker.addClass("with_second_timepicker"),c.animation&&e.picker.addClass("animation"),c.norange&&e.picker.addClass("xdsoft_norange"),c.inline&&e.picker.addClass("xdsoft_inline"),b=function(b){var d,f=!1;if(void 0!==c[b]&&a.isFunction(c[b])){for(d=0;d<e[b].length;d+=1)if(c[b]===e[b][d]){f=!0;break}f||e[b].push(c[b])}},b("onAfterShow"),b("onAfterHide"),b("onAfterRegenerate"),e.maxdate=c.maxDate?new d(c.maxDate,c.formatDate):!1,e.mindate=c.minDate?new d(c.minDate,c.formatDate):!1,e.monthcount=c.cells[0]*c.cells[1],e.picker.css({width:c.cells[1]*c.monthWidthInPixels+(c.timepicker&&a.fn.TimePicker?87*(c.norange?1:2):0)+50,height:c.cells[0]*c.monthHeightInPixels+c.someYOffset})},e.prototype.returnPeriod=function(){this.picker.find("input.period_picker_from").val(void 0!==this.period?this.period:""),this.picker.find("input.period_picker_to").val(void 0!==this.period[1]?this.period[1]:this.picker.find("input.period_picker_from").val())},e.prototype.moveTimeToDate=function(){this.options.timepicker&&this.periodtime.length&&this.periodtime[0].length&&(null!==this.period[0]&&this.period[0].format&&this.periodtime[0][0].format&&(this.period[0].setSeconds(this.periodtime[0][0].getSeconds()),this.period[0].setMinutes(this.periodtime[0][0].getMinutes()),this.period[0].setHours(this.periodtime[0][0].getHours())),null!==this.periodtime[0][1]&&null!==this.period[1]&&this.period[1].format&&this.periodtime[0][1].format&&(this.period[1].setSeconds(this.periodtime[0][1].getSeconds()),this.period[1].setMinutes(this.periodtime[0][1].getMinutes()),this.period[1].setHours(this.periodtime[0][1].getHours())))},e.prototype.getInputsValue=function(){var b,c=[],e=new d,f=this.timepicker.find("input.timepicker");return this.options.timepicker&&void 0!==a.fn.TimePicker&&this.options.useTimepickerLimits&&(e.isEqualDate(this.period[0],this.period[1])?(f.eq(0).TimePicker("setMax",f.eq(1).val()),f.eq(1).TimePicker("setMin",f.eq(0).val())):(f.eq(0).TimePicker("setMax",!1),f.eq(1).TimePicker("setMin",!1))),this.startinput.length&&this.period&&this.period&&this.period.length&&(this.moveTimeToDate(),b=this.options.timepicker?this.options.formatDateTime:this.options.formatDate,this.period[0]&&this.period[0].format&&c.push(this.period[0].format(b)),this.endinput.length&&this.period[1]&&this.period[1].format&&c.push(this.period[1].format(b))),c},e.prototype.setInputsValue=function(){var a=this.getInputsValue();a.length?(a[0]&&this.startinput.val()!==a[0]&&this.startinput.val(a[0]).trigger("change"),a[1]&&this.endinput.length&&this.endinput.val()!==a[1]&&this.endinput.val(a[1]).trigger("change")):(this.startinput.val("").trigger("change"),this.endinput.val("").trigger("change"))},e.prototype.getLabel=function(){var a,b=[];return this.period.length&&(this.moveTimeToDate(),a=this.options.timepicker?[this.options.formatDecoreDateTimeWithYear||this.options.formatDecoreDateTime||this.options.formatDateTime,this.options.formatDecoreDateTimeWithoutMonth||this.options.formatDecoreDateTime||this.options.formatDateTime,this.options.formatDecoreDateTime||this.options.formatDateTime,this.options.formatDateTime]:[this.options.formatDecoreDateWithYear||this.options.formatDecoreDate||this.options.formatDate,this.options.formatDecoreDateWithoutMonth||this.options.formatDecoreDate||this.options.formatDate,this.options.formatDecoreDate||this.options.formatDate,this.options.formatDate],void 0!==this.period[1]&&this.period[1]&&void 0!==this.period[1].format&&this.period[1].format&&this.period[0].format(a[3])!==this.period[1].format(a[3])?(b.push(this.period[0].format(this.period[0].format("YYYY")!==this.period[1].format("YYYY")?a[0]:this.period[0].format("M")!==this.period[1].format("M")?a[2]:a[1])),b.push(this.period[1].format(a[0]))):b.push(this.period[0].format(a[0]))),b},e.prototype.setLabel=function(){var a=this.getLabel();a.length?(1===a.length?this.button.find(".period_button_content_body").html(a[0]):this.button.find(".period_button_content_body").html("<span>"+a[0]+'</span><span class="period_button_dash">&#8212;</span><span>'+a[1]+"</span>"),this.options.clearButtonInButton&&this.button.find(".icon_clear").show()):(this.button.find(".period_button_content_body").html(this.i18n(this.options.norange?"Choose date":"Choose period")),this.button.find(".icon_clear").hide())},e.prototype.highlightPeriod=function(){var b=this;clearTimeout(b.timer1),b.timer1=setTimeout(function(){var c=new d;b.picker.find(".period_picker_cell.period_picker_selected").removeClass("period_picker_selected"),b.period.length?(moment.locale(b.options.lang),b.picker.find(".period_picker_cell").each(function(){var d=c.parseStr(a(this).data("date"),b.options.formatDate);c.inRange(d,b.period)&&a(this).addClass("period_picker_selected")}),b.picker.find(".period_picker_years_period").css({width:Math.floor(b.options.yearSizeInPixels/365*Math.abs(moment(b.period[1]).diff(b.period[0],"day")))+"px",left:Math.floor(b.options.yearSizeInPixels/365*-moment([b.options.yearsPeriod[0],1,1]).diff(b.period[0],"day"))}),b.picker.find("input.period_picker_from:not(:focus)").val(void 0!==b.period[0]&&b.period[0]?b.period[0].format(b.options.formatDate):""),b.picker.find("input.period_picker_to:not(:focus)").val(void 0!==b.period[1]&&b.period[1]?b.period[1].format(b.options.formatDate):b.picker.find("input.period_picker_from").val()),b.picker.find("input.period_picker_from:not(:focus),input.period_picker_to:not(:focus)").trigger("change")):b.picker.find("input.period_picker_from:not(:focus),input.period_picker_to:not(:focus)").val(""),b.setLabel(),b.setInputsValue()},50)},e.prototype.addRangeTime=function(b,c){var e=new d;this.periodtime[0][0]=e.parseStr(b,this.options.timepickerOptions.inputFormat),this.options.norange?this.periodtime[0][1]=this.periodtime[0][0]:(this.periodtime[0][1]=e.parseStr(c,this.options.timepickerOptions.inputFormat),null===this.periodtime[0][0]&&this.periodtime[0][1]&&(this.periodtime[0][0]=this.periodtime[0][1])),null===this.periodtime[0][0]&&(this.periodtime[0]=[]),this.setLabel(),this.setInputsValue(),this.periodtime.length&&this.periodtime[0].length&&a.fn.TimePicker&&(this.periodtime[0][0]&&this.timepicker.find("input.timepicker").eq(0).TimePicker("setValue",this.periodtime[0][0]),this.periodtime[0][1]&&!this.options.norange&&this.timepicker.find("input.timepicker").eq(1).TimePicker("setValue",this.periodtime[0][1]))},e.prototype.addRange=function(b){var c,e=new d;if(this.options.norange&&(this.director=0),a.isArray(b))this.period=[e.parseStr(b[0],this.options.formatDate),e.parseStr(b[1],this.options.formatDate)],null===this.period[0]&&(this.period=[]),this.director=0;else{if(void 0===this.period&&(this.period=[]),this.period[this.options.norange?0:this.director]=e.parseStr(b,this.options.formatDate),null===this.period[this.director])return this.period=[],void this.highlightPeriod();this.director||(this.period[1]=this.period[this.director].clone()),this.period[0]>this.period[1]&&(c=this.period[0],this.period[0]=this.period[1],this.period[1]=c),this.director=this.director?0:1}this.options.norange&&this.period[0]&&this.period[1]&&this.period[1]!==this.period[0]&&(this.period[1]=this.period[0].clone()),this.highlightPeriod(),this.options.hideAfterSelect&&this.period[0]&&this.period[1]&&this.period[0]!==this.period[1]&&this.hide(),this.month=this.period.length?this.period[0].getMonth()+1:this.options.startMonth,this.year=this.period.length?this.period[0].getFullYear():this.options.startYear},e.prototype.recalcDraggerPosition=function(){var a=this;clearTimeout(this.timer2),this.timer2=setTimeout(function(){var b=Math.abs(parseInt(a.yearsline.css("left"),10)),c=a.picker.find(".period_picker_years_dragger"),d=parseInt(c.css("left"),10);b>d?a.yearsline.css("left",-d+"px"):d+c.width()>b+a.yearslineparent.width()&&a.yearsline.css("left",-(d+c.width()-a.yearslineparent.width())+"px")},100)},e.prototype.calcDate=function(a,b,c,d){a.setFullYear(b),a.setMonth(c),a.setDate(d)},e.prototype.getRealDateTime=function(){var a=new Date;return this.calcDate(a,this.year,this.month-1,1),[a.getMonth(),a.getFullYear()]},e.prototype.regenerate=function(b){if(this.picker.is(":visible")){var c,d=this,e=parseInt(d.pickerdays.width(),10),f=parseInt(d.picker[0].offsetHeight,10);for(moment.locale(d.options.lang),void 0===b?this.options.cells=[Math.floor((f-d.options.someYOffset)/d.options.monthHeightInPixels)||1,Math.floor(e/d.options.monthWidthInPixels)||1]:(this.options.cells=b,d.picker.css({width:this.options.cells[1]*d.options.monthWidthInPixels+(d.options.timepicker&&a.fn.TimePicker?87*(d.options.norange?1:2):0)+50,height:this.options.cells[0]*d.options.monthHeightInPixels+d.options.someYOffset})),this.options.cells[0]<0&&(this.options.cells[0]=1),d.monthcount=this.options.cells[0]*this.options.cells[1],d.generateCalendars(d.month,d.year),d.generateYearsLine(),d.recalcDraggerPosition(),d.highlightPeriod(),c=0;c<this.onAfterRegenerate.length;c+=1)this.onAfterRegenerate[c].call(this)}},e.prototype.init=function(){var e,g,h,i,j,k,l,m,n,o,p,q=this;q.button.on("click",function(a){return q.button.is("[disabled]")?(a.preventDefault(),!1):void q.toggle()}),q.options.inline||q.startinput.after(q.button),e=q.startinput.offset(),q.picker.find(".period_picker_submit_dates input").on("focus",function(){a(this).parent().parent().addClass("input_focused_yes")}).on("blur",function(){a(this).parent().parent().removeClass("input_focused_yes")}),q.picker.find(".period_picker_submit_dates .period_picker_date input").on("keydown",function(){var b=this;clearTimeout(q.timer3),q.timer3=setTimeout(function(){if(a(b).val()){var c=moment(a(b).val(),q.options.formatDate);if(!c.isValid())return void a(b).parent().parent().addClass("period_picker_error");q.addRange([q.picker.find(".period_picker_submit_dates .period_picker_date input").eq(0).val(),q.picker.find(".period_picker_submit_dates .period_picker_date input").eq(1).val()])}a(b).parent().parent().removeClass("period_picker_error")},200)}),q.options.timepicker&&a.fn.TimePicker&&(p=q.picker.find(".period_picker_submit_dates .period_picker_time input").on("keydown change",function(){var b=this;clearTimeout(q.timer4),q.timer4=setTimeout(function(){var c,e=new d;if(a(b).val()){if(c=moment(a(b).val(),q.options.timepickerOptions.inputFormat),!c.isValid())return void a(b).parent().parent().addClass("period_picker_error");if(this.period&&this.period.length&&e.isEqualDate(this.period[0],this.period[1])&&moment(p.eq(0).val(),q.options.timepickerOptions.inputFormat).getDate().getTime()>moment(p.eq(1).val(),q.options.timepickerOptions.inputFormat).getDate().getTime())return void a(b).parent().parent().addClass("period_picker_error");q.addRangeTime(q.picker.find(".period_picker_submit_dates .period_picker_time input").eq(0).val(),q.picker.find(".period_picker_submit_dates .period_picker_time input").eq(1).val())}a(b).parent().parent().removeClass("period_picker_error")},200)})),q.picker.find(".period_picker_max_min").on("click",function(){q.picker.toggleClass("period_picker_maximize"),q.regenerate()}),q.options.fullsizeOnDblClick&&q.picker.find(".period_picker_head").on("dblclick",function(){q.picker.toggleClass("period_picker_maximize"),q.regenerate()}),q.picker.find(".period_picker_close").on("click",function(){q.hide()}),q.options.mousewheel&&(q.picker.on("mousewheel",function(a){return q.month+=(q.options.reverseMouseWheel?-1:1)*a.deltaY,q.regenerate(),!1}),q.options.mousewheelYearsLine&&q.picker.find(".period_picker_years_selector").on("mousewheel",function(a){return q.year+=(q.options.reverseMouseWheel?-1:1)*a.deltaY,q.month=1,q.regenerate(),a.preventDefault(),a.stopPropagation(),!1})),q.options.navigate&&q.picker.find(".xdsoft_navigate").on("click",function(){return q.month+=a(this).hasClass("xdsoft_navigate_prev")?-1:1,q.regenerate(),!1}),q.picker.on("click",".period_picker_show.period_picker_ok",function(){q.hide(),q.options.onOkButtonClick&&a.isFunction(q.options.onOkButtonClick)&&q.options.onOkButtonClick.call(q)}),q.options.clearButtonInButton&&q.button.find(".icon_clear").on("mousedown",function(a){return q.clear(),a.preventDefault(),a.stopPropagation(),!1}),q.options.clearButton&&q.picker.on("click",".period_picker_show.period_picker_clear",function(){q.clear()}),q.picker.on("click",".period_picker_years_selector .period_picker_year",function(){q.year=parseInt(a(this).text(),10),q.month=-Math.floor(q.monthcount/2)+1,q.regenerate()}),q.picker.on("mousedown",".period_picker_days td td,.period_picker_month",function(){if(a(this).hasClass("period_picker_month"))q.addRange([a(this).data("datestart"),a(this).data("dateend")]);else if(!a(this).hasClass("period_picker_gray_period"))if(a(this).hasClass("period_picker_selector_week")){var b=parseInt(a(this).parent().data("week"),10),c=q.picker.find("tr[data-week="+b+"] > td.period_picker_cell:not(.period_picker_gray_period)"),d=c.eq(-1),e=c.eq(0);d.length&&q.addRange([e.data("date"),d.data("date")])}else 1!==q.picker.find(".period_picker_selected").length?(q.picker.find(".period_picker_selected").removeClass("period_picker_selected"),a(this).addClass("period_picker_selected")):a(this).addClass("period_picker_selected"),q.addRange(a(this).data("date"))}),q.picker.on("mousedown",".period_picker_years_selector_container",function(b){n=a(this),o=!0,g=[b.clientX,b.clientY,parseInt(n.css("left")||0,10)],b.preventDefault()}),q.picker.on("mousedown",".period_picker_years_dragger",function(b){k=a(this),j=!0,g=[b.clientX,b.clientY,parseInt(k.css("left"),10)],b.stopPropagation(),b.preventDefault()}),q.options.draggable&&q.picker.on("mousedown",".period_picker_head",function(a){m=!0,g=[a.clientX,a.clientY,parseInt(q.picker.css("left"),10),parseInt(q.picker.css("top"),10)],a.preventDefault()}),q.picker.on("mouseup",function(b){i=!1,j=!1,m=!1,o=!1,q.options.timepicker&&a.fn.TimePicker&&q.timepicker.find("input.timepicker").TimePicker("stopDrag"),b.stopPropagation()}),q.picker.find(".period_picker_resizer").on("mousedown",function(a){i=!0,g=[a.clientX,a.clientY,parseInt(q.picker.css("width"),10),parseInt(q.picker.css("height"),10)],a.preventDefault()}),q.picker.css({left:q.options.inline?"auto":e.left,top:q.options.inline?"auto":e.top+q.button.height(),width:this.options.cells[1]*q.options.monthWidthInPixels+(q.options.timepicker&&a.fn.TimePicker?87*(q.options.norange?1:2):0)+50,height:this.options.cells[0]*q.options.monthHeightInPixels+q.options.someYOffset}),q.options.noHideSourceInputs||q.options.likeXDSoftDateTimePicker?(q.startinput.add(q.endinput).on("keydown.xdsoftpp mousedown.xdsoftpp",function(){clearTimeout(f),f=setTimeout(function(){var a,b=q.getInputsValue(),c=q.options.timepicker?q.options.formatDateTime:q.options.formatDate;(void 0!==b[0]&&b[0]!==q.startinput.val()||void 0!==b[1]&&q.endinput.length&&b[1]!==q.endinput.val())&&(a=new d,q.addRange([a.parseStr(q.startinput.val(),c),a.parseStr(q.endinput.val(),c)]),q.period[0]&&(q.year=q.period[0].getFullYear(),q.month=q.period[0].getMonth()+1,q.regenerate()))},300)}),q.options.likeXDSoftDateTimePicker&&(q.button.remove(),q.startinput.add(q.endinput).on("open.xdsoftpp focusin.xdsoftpp mousedown.xdsoftpp touchstart.xdsoftpp",function(){var b=this;a(b).is(":disabled")||q.picker.hasClass("visible")||(clearTimeout(f),f=setTimeout(function(){q.show(b)},100))}),q.options.hideOnBlur&&q.startinput.add(q.endinput).on("blur.xdsoftpp",function(){setTimeout(function(){q.picker.find("*:focus").length||q.hide()},200)}))):(q.startinput.hide(),q.endinput.hide()),q.options.inline?(q.startinput.after(q.picker),q.show()):a(c.body).append(q.picker),a(b).on("resize.xdsoftpp"+q.uniqueid,function(){q.regenerate()}).on("mouseup.xdsoftpp"+q.uniqueid,function(a){i||j||m||o?(i=!1,j=!1,m=!1,o=!1):q.options.inline||(q.hide(),q.options.likeXDSoftDateTimePicker&&(q.startinput.is(a.target)||q.endinput.is(a.target))&&q.show(a.target))}).on("mousemove.xdsoftpp"+q.uniqueid,function(a){m&&!q.options.inline&&(h=[a.clientX-g[0],a.clientY-g[1]],q.picker.hasClass("xdsoft_i_moved")||q.picker.addClass("xdsoft_i_moved"),q.picker.css({left:g[2]+h[0],top:g[3]+h[1]})),i&&(h=[a.clientX-g[0],a.clientY-g[1]],q.picker.css({width:g[2]+h[0],height:g[3]+h[1]}),q.regenerate()),j&&(h=[a.clientX-g[0],a.clientY-g[1]],l=g[2]+h[0],k.css("left",l),q.calcMonthOffsetFromPeriodDragger(l),q.generateCalendars(q.month,q.year),q.recalcDraggerPosition()),o&&(h=[a.clientX-g[0],a.clientY-g[1]],l=g[2]+h[0],n.css("left",l))}),q.generateTimePicker()},e.prototype.generateTimePicker=function(){var b=this;b.options.timepicker&&void 0!==a.fn.TimePicker&&!b.timepickerAlreadyGenerated&&(b.timepicker.each(function(){var c=a(this).find("input.timepicker"),d=parseInt(c.data("index")||0,10);c.length&&!c.data("timepicker")&&void 0!==a.fn.TimePicker&&(d&&b.options.defaultEndTime&&(b.options.timepickerOptions.defaultTime=b.options.defaultEndTime),c.TimePicker(b.options.timepickerOptions,a(this)),b.onAfterRegenerate.push(function(){c.TimePicker("regenerate")}),c.on("change",function(){b.picker.find(".period_picker_submit_dates .period_picker_time input").eq(d).val(this.value).trigger("change")}).trigger("change"))}),b.timepickerAlreadyGenerated=!0)},e.prototype.generateCalendars=function(a,b){function c(){var a,b=[];for(a=0;a<i.length;a+=1)b.push('<th class="'+(-1!==f.options.weekEnds.indexOf(a+f.options.dayOfWeekStart>7?(a+f.options.dayOfWeekStart)%7:a+f.options.dayOfWeekStart)?"period_picker_holiday":"")+'">'+i[a]+"</th>");return b.join("")}moment.locale(this.options.lang);var e,f=this,g=[],h=f.getRealDateTime(),i=(new d).weekdays(f.options.dayOfWeekStart);for(h[1]>f.options.yearsPeriod[1]&&(f.year=f.options.yearsPeriod[1],b=f.year,f.month=12-f.monthcount,a=f.month),h[1]<f.options.yearsPeriod[0]&&(f.year=f.options.yearsPeriod[0],b=f.year,f.month=1,a=f.month),g.push('<tr class="period_picker_first_letters_tr">'),e=0;e<f.options.cells[1];e+=1)g.push('<td class="period_picker_first_letters_td"><table class="period_picker_first_letters_table"><tbody><tr><th class="period_picker_selector_week_cap"><span class="period_picker_selector_week_cap"></span></th>'+c()+"</tr></tbody></table></td>");for(g.push("</tr>"),e=0;e<f.options.cells[0];e+=1)g.push("<tr>"),g.push(f.generateCalendarLine(a+e*f.options.cells[1],b,f.options.cells[1])),g.push("</tr>");f.calendarbox.html(g.join("")),f.highlightPeriod()},e.prototype.i18n=function(a){return void 0!==this.options.i18n[this.options.lang]&&void 0!==this.options.i18n[this.options.lang][a]?this.options.i18n[this.options.lang][a]:a},e.prototype.calcPixelOffsetForPeriodDragger=function(){var a=this.getRealDateTime();return(a[1]-this.options.yearsPeriod[0])*this.options.yearSizeInPixels+a[0]*Math.floor(this.options.yearSizeInPixels/12)},e.prototype.calcMonthOffsetFromPeriodDragger=function(a){this.year=Math.floor(a/this.options.yearSizeInPixels)+this.options.yearsPeriod[0],this.month=Math.floor(a%this.options.yearSizeInPixels/Math.floor(this.options.yearSizeInPixels/12))+1},e.prototype.generateYearsLine=function(){if(this.options.yearsLine){var b,c=[],d=0;if(c.push('<div class="period_picker_years_dragger" title="'+this.i18n("Move to select the desired period")+'" style="left: '+this.calcPixelOffsetForPeriodDragger()+"px; width: "+Math.floor(this.options.yearSizeInPixels/12)*this.monthcount+'px;"></div>'),c.push('<div class="period_picker_years_period" style="display: block; width: 0px; left: 300px;"></div>'),this.options.yearsPeriod&&a.isArray(this.options.yearsPeriod))for(b=this.options.yearsPeriod[0];b<=this.options.yearsPeriod[1];b+=1)c.push('<div class="period_picker_year" style="left:'+d*this.options.yearSizeInPixels+'px">'+b+"</div>"),d+=1;this.yearsline.css("width",d*this.options.yearSizeInPixels+"px"),this.yearsline.html(c.join(""))}},e.prototype.generateCalendarLine=function(a,b,c){var e,f,g,h,i,j,k=[],l=new d;for(l.setDate(1),l.setMonth(a-1),l.setFullYear(b),e=0;c>e;e+=1){for(i=l.getMonth()+1,h=l.countDaysInMonth(),k.push('<td class="period_picker_month'+l.format("M")+'"><table><tbody>'),k.push('<tr><th class="period_picker_month" data-datestart="'+l.format(this.options.formatDate)+'"  data-dateend="'+l.clone(0,0,h).format(this.options.formatDate)+'" colspan="8" title="'+l.format(this.options.formatMonth)+'">'+l.format(this.options.formatMonth)+"<b>"+l.format("M.YYYY")+"</b></th></tr>"),j=0;l.format("E")!==this.options.dayOfWeekStart&&7>j;)l.setDate(l.getDate()-1),j+=1;for(f=1,j=0;h>=f&&100>j;){for(k.push('<tr data-week="'+l.format("W")+'">'),k.push('<td class="period_picker_selector_week" title="'+this.i18n("Select week #")+" "+l.format("W")+'"><span class="period_picker_selector_week"></span></td>'),g=1;7>=g;g+=1)l.format("M")!==i?k.push('<td class="period_picker_empty">&nbsp;</td>'):((!this.maxdate||l<this.maxdate)&&(!this.mindate||l>this.mindate)&&-1===this.options.disableDays.indexOf(l.format(this.options.formatDate))?(k.push('<td data-date="'+l.format(this.options.formatDate)+'"'),k.push('    class="period_picker_cell '),k.push(-1!==this.options.weekEnds.indexOf(l.format("E"))||-1!==this.options.holidays.indexOf(l.format(this.options.formatDate))?" period_picker_holiday":" period_picker_weekday"),k.push((7===g||l.format("D")===h?" period_picker_last_cell":"")+'">'+l.format("D")+"</td>")):k.push('<td class="period_picker_gray_period">'+l.format("D")+"</td>"),f+=1),l.setDate(l.getDate()+1);j+=1,k.push("</tr>")}a+=1,l.setDate(1),l.setMonth(a-1),l.setFullYear(b),k.push("</tbody></table></td>")}return k.join("")},e.prototype.toggle=function(){this.picker.hasClass("active")?this.hide():this.show()},e.prototype.clear=function(){this.addRange(),this.options.onClearButtonClick&&a.isFunction(this.options.onClearButtonClick)&&this.options.onClearButtonClick.call(this),this.options.closeAfterClear&&!this.options.inline&&this.hide()},e.prototype.show=function(c){var d,e,f,g;for(this.options.inline||(this.picker.addClass("visible").addClass("active"),this.options.fullsize?this.picker.addClass("period_picker_maximize"):this.picker.hasClass("xdsoft_i_moved")||(e=this.options.likeXDSoftDateTimePicker?a(c).offset():this.button.offset(),f=e.top+(this.options.likeXDSoftDateTimePicker?a(c).outerHeight():this.button.outerHeight())-1,g=e.left,f+this.picker.outerHeight()>a(b).height()+a(b).scrollTop()&&(f=e.top-this.picker.outerHeight()-1),0>f&&(f=0),g+this.picker.outerWidth()>a(b).width()&&(g=a(b).width()-this.picker.outerWidth()),this.picker.css({left:g,top:f}))),this.regenerate(),d=0;d<this.onAfterShow.length;d+=1)this.onAfterShow[d].call(this)},e.prototype.hide=function(){var a,b=this;if(b.picker.hasClass("visible")&&(b.picker.removeClass("active"),b.picker.hasClass("animation")?setTimeout(function(){b.picker.hasClass("active")||b.picker.removeClass("visible")},300):b.picker.removeClass("visible")),void 0!==this.onAfterHide&&this.onAfterHide.length)for(a=0;a<this.onAfterHide.length;a+=1)this.onAfterHide[a].call(this)},e.prototype.destroy=function(){this.picker.remove(),this.button.remove(),this.startinput.off(".xdsoftpp").show(),this.endinput.off(".xdsoftpp").show(),a(b).off(".xdsoftpp"+this.uniqueid)},a.fn.periodpicker=function(c,f,g){if(void 0===b.moment)throw new Error("PeriodPicker's JavaScript requires MomentJS");var h=this;return this.each(function(){var b,i,j=[],k=a(this),l=k.data("periodpicker");if(l)switch(b=l.options,c){case"picker":h=l;break;case"regenerate":l.regenerate(f);break;case"setOption":l.options[f]=g,l.applyOptions();break;case"setOptions":l.options=a.extend(!0,{},l.options,f),l.applyOptions();break;case"clear":l.addRange();break;case"change":l.addRange([l.startinput.val(),l.endinput.val()]);break;case"destroy":l.destroy();break;case"hide":l.hide();break;case"show":l.show();break;case"value":void 0!==f?(i=new d,a.isArray(f)?(j[0]=i.parseStr(f[0],b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(f[0],b.formatDate),void 0!==f[1]&&(j[1]=i.parseStr(f[1],b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(f[1],b.formatDate))):j[0]=i.parseStr(f,b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(f,b.formatDate),l.addRange(j),b.timepicker&&void 0!==a.fn.TimePicker&&l.addRangeTime(j[0],j[1]||j[0])):h=l.period;break;case"valueStringStrong":h=l.getInputsValue().join("-");break;case"valueString":h=l.getLabel().join("-");break;case"disable":l.button.attr("disabled",!0),l.startinput.add(l.endinput).attr("disabled",!0).attr("readonly",!0);break;case"enable":l.button.removeAttr("disabled"),l.startinput.add(l.endinput).removeAttr("disabled").removeAttr("readonly")}else b=a.extend(!0,{},a.fn.periodpicker.defaultOptions,c),l=new e(this,b),k.data("periodpicker",l)}),h},a.fn.periodpicker.defaultOptions={animation:!0,lang:"en",i18n:{en:{"Select week #":"Select week #","Select period":"Select period","Select date":"Select date","Choose period":"Select period","Choose date":"Select date",Clear:"Clear"},ru:{"Move to select the desired period":"Переместите, чтобы выбрать нужный период","Select week #":"Выбрать неделю №","Select period":"Выбрать период","Select date":"Выбрать дату","Open fullscreen":"Открыть на весь экран",Close:"Закрыть",OK:"OK","Choose period":"Выбрать период","Choose date":"Выбрать дату",Clear:"Отчистить"
},fr:{"Move to select the desired period":"Déplacer pour sélectionner la période désirée","Select week #":"Sélectionner la semaine #","Select period":"Choisissez une date","Select date":"Sélectionner la date","Open fullscreen":"Ouvrir en plein écran",Close:"Fermer",OK:"OK","Choose period":"Choisir la période","Choose date":"Choisir une date",Clear:"Propre"}},withoutBottomPanel:!1,showTimepickerInputs:!0,showDatepickerInputs:!0,timepicker:!1,useTimepickerLimits:!0,timepickerOptions:{inputFormat:"HH:mm"},defaultEndTime:!1,yearsLine:!0,title:!0,inline:!1,clearButtonInButton:!1,clearButton:!1,closeAfterClear:!0,okButton:!0,closeButton:!0,fullsizeButton:!0,resizeButton:!0,navigate:!0,fullsizeOnDblClick:!0,fullsize:!1,draggable:!0,mousewheel:!0,mousewheelYearsLine:!0,reverseMouseWheel:!0,hideAfterSelect:!1,hideOnBlur:!0,norange:!1,formatMonth:"MMMM YYYY",formatDecoreDate:"D MMMM",formatDecoreDateWithYear:"D MMMM YYYY",formatDecoreDateWithoutMonth:"D",formatDecoreDateTimeWithoutMonth:"HH:mm D",formatDecoreDateTime:"HH:mm D MMMM",formatDecoreDateTimeWithYear:"HH:mm D MMMM YYYY",formatDateTime:"HH:mm YYYY/MM/D",formatDate:"YYYY/MM/D",end:"",noHideSourceInputs:!1,likeXDSoftDateTimePicker:!1,startMonth:(new Date).getMonth()+1,startYear:(new Date).getFullYear(),dayOfWeekStart:1,yearSizeInPixels:120,timepickerWidthInPixels:50,monthWidthInPixels:184,monthHeightInPixels:174,someYOffset:150,yearsPeriod:[2e3,(new Date).getFullYear()+20],weekEnds:[6,7],holidays:[],disableDays:[],minDate:!1,maxDate:!1,cells:[1,3],onOkButtonClick:!1,onAfterShow:!1,onAfterHide:!1,onAfterRegenerate:!1},void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(a,b){var c,d;for(d=this.length,c=b||0;d>c;c+=1)if(this[c]===a)return c;return-1})}(jQuery,window,document);