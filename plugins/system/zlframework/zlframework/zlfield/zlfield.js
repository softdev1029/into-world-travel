/**
 * @package     ZOOlanders
 * @version     3.3.27
 * @author      ZOOlanders - http://zoolanders.com
 * @license     GNU General Public License v2 or later
 */

!function(t){var i=function(){};i.prototype=t.extend(i.prototype,{name:"ZLfield",options:{url:"",type:"",enviroment:"",enviroment_args:""},initialize:function(e,i){this.options=t.extend({},this.options,i);var n=this;t("#toolbar-apply, #toolbar-save").click(function(){return t(".zlfield input").each(function(){t(this).val()||t(this).remove()}),!0}),t(document).ready(function(){"undefined"!=typeof zl_options&&void 0!==zl_options.max_input_vars&&jQuery("textarea, input, select").length>zl_options.max_input_vars&&alert("WARNING! Please increase the max_input_vars option in php.ini or contact ZOOlanders support for more information."),t(".zlfield-main .chzn-container").each(function(){t(this).prev("select").data("chosen",null).show(),t(this).remove()}),t(".col-left ul.element-list").on("element.added",function(e,i){n.actions(t(i))}),t("ul.ui-sortable").on("sortstop",function(e,i){var a=RegExp(/(elements\[[a-z0-9_-]+\])|(positions\[[a-z0-9_-]+\]\[[0-9]+\])/);t("#assign-elements ul.element-list:not(.unassigned)").each(function(){var e="positions["+t(this).data("position")+"]";t(this).children().each(function(i){t(this).find("[data-control^=positions], [data-control^=elements]").each(function(){t(this).attr("data-control","tmp"+t(this).attr("data-control").replace(a,e+"["+i+"]"))})})}),a=RegExp(/^tmp/),t("#assign-elements ul.element-list").find("[data-control^=tmp]").each(function(){t(this).attr("data-control",t(this).attr("data-control").replace(a,""))}),n.actions(i.item)}),n.initActions()})},initActions:function(){var e=this,i=e.options.enviroment;("type-positions"==i||"type-edit"==i)&&t(".col-left ul.ui-sortable > li.element").each(function(){t(this).parent().trigger("sortstop",{item:t(this)})}),"type-edit"==i&&t(".col-left .core-element-configuration .element-list > li.element").each(function(){e.actions(t(this))}),"item-edit"==i&&t(".item-edit .creation-form .zlfield-main").each(function(){e.actions(t(this))}),"module"==i&&t("form#module-form .zlfield-main").each(function(){t(this).closest("li, .control-group").addClass("zlfield-module"),t(this).closest(".controls").removeClass("controls"),e.actions(t(this))}),"app-config"==i&&t(".col-right .zlfield-main").each(function(){e.actions(t(this))})},actions:function(i){var n=this;i.data("zlfield-actions-init")||(i.find(".qTipHelp").each(function(){var e=t(this);e.qtip({overwrite:!1,content:{text:e.find(".qtip-content")},position:{my:"bottom center",at:"top center",viewport:t(window)},show:{solo:!0,delay:300},hide:{fixed:!0,delay:300},style:"ui-tooltip-light ui-tooltip-zlparam"})}),i.find(".zl-select-expand").each(function(){var e=t(this);e.click(function(){t(this).prev().height(150),t(this).remove()}).qtip({overwrite:!1,content:{text:e.data("zl-qtip")},position:{at:"right top",my:"left bottom"},show:{solo:!0,delay:600},hide:{delay:0},style:"ui-tooltip-light ui-tooltip-zlparam"})}),t("#toolbar-apply, #toolbar-save").on("mousedown",function(){i.find(".zl-row[data-type=password] .zl-field input").each(function(){t(this).val("zl-decrypted["+t(this).val()+"]")})}),i.find(".zl-state").each(function(){var e=t(this).find("input"),i=e.closest(".zl-row");e.on("change",function(){"checked"==t(this).attr("checked")?(i.removeClass("zl-disabled"),i.find(".zl-field").children().removeAttr("disabled")):(i.addClass("zl-disabled"),i.find(".zl-field").children().attr("disabled",!0))}).trigger("change")}),i.find(".zl-state input").each(function(){var e=t(this);e.qtip({content:{text:"Override this field"},position:{at:"left top",my:"right bottom",effect:!1},show:{target:e.closest(".zl-row"),solo:!0,delay:200},hide:{target:e.closest(".zl-row"),delay:0},style:"ui-tooltip-light ui-tooltip-zlparam",events:{show:function(t,i){"checked"==e.attr("checked")&&t.preventDefault(),e.bind("change",function(){i.hide()}),i.set("content.text",e.parent().attr("tooltip"))}}})}),i.find(".zl-toggle").each(function(){var e=t(this),i=e.next();t(".btn-open",e).on("click",function(){e.toggleClass("open")&&i.show()}),t(".btn-close",e).on("click",function(){e.toggleClass("open")&&i.hide()})}),i.find("[data-dependents]").each(function(){var i=t(this),n=i.data("dependents").replace(/ /g,"").split("|"),a=i.closest(".zlfield.placeholder .wrapper, .zlfield.placeholder").first();n.forEach(function(n){var l=n.split("!>"),o=2==l.length?"!>":">";l=">"==o?n.split(">"):l,d=l[0].split(","),e=l[1].replace("NONE",""),("select"==i.data("type")||"itemLayoutList"==i.data("type")||"layout"==i.data("type")||"apps"==i.data("type")||"types"==i.data("type")||"elements"==i.data("type")||"modulelist"==i.data("type")||"separatedby"==i.data("type"))&&d.forEach(function(n){var l=a.find('[data-id="'+n+'"]').data("e",e).data("m",o).hide();i.find(".zl-field select").bind("change",function(){var e=l.data("e"),i=l.data("m"),n=t.makeArray(t(this).val()),a=0;if(e&&e.match(/OR/g))t.each(n,function(t,n){var l=new RegExp("(\\b|OR)"+n+"(\\b|OR)","g");("!>"==i&&!e.match(l)||">"==i&&e.match(l))&&(a=1)});else if(e&&e.match(/AND/g)){var o=e.split("AND").length;n.length==o&&t.each(n,function(t,n){var l=new RegExp("(\\b|AND)"+n+"(\\b|AND)","g");a="!>"==i&&!e.match(l)||">"==i&&e.match(l)?1:0})}else t.each(n,function(t,n){("!>"==i&&n!=e||">"==i&&n==e)&&(a=1)});a&&l.slideDown("fast")||l.slideUp("fast")}).trigger("change")}),"checkbox"==i.data("type")&&d.forEach(function(e){var n=a.find('[data-id="'+e+'"]').hide();i.find(".zl-field input").bind("change",function(){var e="checked"==t(this).attr("checked");("!>"==o&&!e||">"==o&&e)&&n.slideDown("fast")||n.slideUp("fast")}).trigger("change")}),"radio"==i.data("type")&&d.forEach(function(n){var l=e,d=a.find('[data-id="'+n+'"]').hide();i.find(".zl-field input").bind("change",function(){var e="checked"==t(this).attr("checked"),i=0,n=t(this).attr("value");if(e){if(l&&l.match(/OR/g)){var a=new RegExp(n,"g");("!>"==o&&!l.match(a)||">"==o&&l.match(a))&&(i=1)}else("!>"==o&&n!=l&&e||">"==o&&n==l&&e&&e)&&(i=1);i&&d.slideDown("fast")||d.slideUp("fast")}}).trigger("change")}),"text"==i.data("type")&&d.forEach(function(e){var n=a.find('[data-id="'+e+'"]').hide();i.find(".zl-field input").on("keyup change",function(){var e=""!=t(this).val();("!>"==o&&!e||">"==o&&e)&&n.slideDown("fast")||n.slideUp("fast")}).trigger("change")})})}),i.find("[data-dependent]").each(function(){var e=t(this).hide(),i=e.data("dependent").replace(/ /g,""),a=i.match(/AND/g)?i.split("AND"):[],l=i.match(/OR/g)?i.split("OR"):[],o=e.parents(".zlfield.placeholder .wrapper, .zlfield.placeholder").first();e.on("zlfield-dependent-event",function(t){A_match=0,a.length?A_match=n.evaluateDependentRules(a,e,o,"AND"):A_match=n.evaluateDependentRules(l,e,o,"OR"),A_match&&e.slideDown("fast")||e.slideUp("fast")}).trigger("zlfield-dependent-event")}),i.find("[data-relieson]").each(function(){var e=t(this),i=e.data("relieson"),a=e.parents(".placeholder").find('[data-id="'+i.id+'"]'),l=a.find("select");l.on("change",function(){var a=t(this).val()?t(this).val():"",o=t(this).closest(".zl-field"),d=i.json,s=e.attr("data-control"),c=t(this).closest(".zlfield-main").attr("data-ajaxargs"),r=i.psv,p=i.id;r[i.id]=a,o.append(t('<span class="activity zl-loader">'));t.ajax({type:"POST",url:i.url+"&task=loadfield",data:{json:d,ctrl:s,psv:r,pid:p,node:null,args:c,ajaxcall:!0,enviroment:n.options.enviroment,enviroment_args:n.options.enviroment_args}}).done(function(i){i=t.parseJSON(i),o.find(".activity").remove(),e.slideUp("fast",function(){e.empty(),i&&i.result&&e.html('<div class="loaded-fields">'+i.result+"</div>"),n.actions(e.find("> .loaded-fields")),e.slideDown("fast"),l.trigger("loaded.zlfield")})})})}),i.find(".load-field-btn").on("click",function(e){e.preventDefault();var i=t(this),a=i.parent(".zlfield-main"),l=a.data("ajaxargs");i.find("span").addClass("zlux-loader-raw"),t.ajax({url:n.options.url,type:"POST",data:{task:"loadZLfield",group:l.group,type:n.options.type,control_name:l.control_name,json_path:l.json_path,element_id:l.element_id,element_type:l.element_type,enviroment:l.enviroment,node:l.node},success:function(e){e=t.parseJSON(e),a.fadeOut("fast",function(){t(this).html(e.result),n.actions(a),a.fadeIn("slow")})}})}),t("[data-type=items] .zl-field",i).each(function(){var e=t(this),i=t("input.zlux-x-dummy",e),n=i.val(),a=i.data("params");i.remove(),t.zlux.assets.load("fields").done(function(){e.zlux("fields",t.extend({},a,{field:"items",controlName:n}))})}),t("[data-type=options] .zl-field",i).each(function(){var e=t(this),i=t("input.zlux-x-dummy",e),n=i.val(),a=i.data("params");i.remove(),t.zlux.assets.load("fields").done(function(){e.zlux("fields",t.extend({},a,{field:"options",controlName:n}))})}),t("[data-type=attributes] .zl-field",i).each(function(){var e=t(this),i=t("input.zlux-x-dummy",e),n=i.val(),a=i.data("params");i.remove(),t.zlux.assets.load("fields").done(function(){e.zlux("fields",t.extend({},a,{field:"attributes",controlName:n}))})}),i.data("zlfield-actions-init",!0))},evaluateDependentRules:function(i,n,a,l){var o=0,d=1;return i.forEach(function(i){if(!d)return!1;var s=i.split("!="),c=2==s.length?"!=":"==";if(s="=="==c?i.split("=="):s,field=a.find('[data-id="'+s[0]+'"]'),type=field.data("type"),unique_id=l+"-"+n.data("id")+"-"+field.data("id")+"-"+a.data("id"),e=s[1].replace("NONE",""),"select"==type||"itemLayoutList"==type||"layout"==type||"apps"==type||"types"==type||"elements"==type||"modulelist"==type||"separatedby"==type){var r=field.find(".zl-field select"),p=t.makeArray(r.val()),f=0;if(e&&e.match(/OR/g))t.each(p,function(t,i){var n=new RegExp("(\\b|OR)"+i+"(\\b|OR)","g");("!="==c&&!e.match(n)||"=="==c&&e.match(n))&&(f=1)});else if(e&&e.match(/AND/g)){var h=e.split("AND").length;p.length==h&&t.each(p,function(t,i){var n=new RegExp("(\\b|AND)"+i+"(\\b|AND)","g");f="!="==c&&!e.match(n)||"=="==c&&e.match(n)?1:0})}else t.each(p,function(t,i){("!="==c&&i!=e||"=="==c&&i==e)&&(f=1)});o=f,r.data("zlfield-dependent-"+unique_id+"-init")||(r.on("change",function(){n.trigger("zlfield-dependent-event")}),r.data("zlfield-dependent-"+unique_id+"-init",!0))}if("checkbox"==type){var u=field.find(".zl-field input"),f=0,m="checked"==u.attr("checked");("!="==c&&!m||"=="==c&&m)&&(f=1),o=f,u.data("zlfield-dependent-"+unique_id+"-init")||(u.on("change",function(){n.trigger("zlfield-dependent-event")}),u.data("zlfield-dependent-"+unique_id+"-init",!0))}if("radio"==type){var v=field.find(".zl-field input"),f=0,g=e;v.each(function(){var e="checked"==t(this).attr("checked"),i=t(this).attr("value");if(e)if(g&&g.match(/OR/g)){var n=new RegExp(i,"g");("!="==c&&!g.match(n)||"=="==c&&g.match(n))&&(f=1)}else("!="==c&&i!=g&&e||"=="==c&&i==g&&e&&e)&&(f=1)}),o=f,v.data("zlfield-dependent-"+unique_id+"-init")||(v.on("change",function(){n.trigger("zlfield-dependent-event")}),v.data("zlfield-dependent-"+unique_id+"-init",!0))}if("text"==type){var y=field.find(".zl-field input"),z=""!=y.val();("!="==c&&!z||"=="==c&&z)&&(f=1),o=f,y.data("zlfield-dependent-"+unique_id+"-init")||(y.on("keyup change",function(){n.trigger("zlfield-dependent-event")}),y.data("zlfield-dependent-"+unique_id+"-init",!0))}("AND"==l&&!o||"OR"==l&&o)&&(d=!1)}),o}}),t.fn[i.prototype.name]=function(){var e=arguments,n=e[0]?e[0]:null;return this.each(function(){var a=t(this);if(i.prototype[n]&&a.data(i.prototype.name)&&"initialize"!=n)a.data(i.prototype.name)[n].apply(a.data(i.prototype.name),Array.prototype.slice.call(e,1));else if(!n||t.isPlainObject(n)){var l=new i;i.prototype.initialize&&l.initialize.apply(l,t.merge([a],e)),a.data(i.prototype.name,l)}else t.error("Method "+n+" does not exist on jQuery."+i.name)})}}(jQuery),function(e,t){e(function(){e(".wk2-zl-selector").each(function(i,n){var a,l=e(this).nextAll("input"),o=e(this).nextAll("span");try{a=JSON.parse(l.val())}catch(e){a={}}a.widget&&t.widgetkit.config.widgets[a.widget]&&o.html("("+t.widgetkit.config.widgets[a.widget].label+")")})}),e(function(){e("body").on("click",".wk2-zl-selector",function(i){i.preventDefault();var n,a,l=e(this).nextAll("input"),o=e(this).nextAll("span");e(this).data("zl-widgets");try{n=JSON.parse(l.val())}catch(i){n={}}t.zlwk.env.init(n,function(e){a.widget&&o.html("("+a.widget.label+")"),l.val(JSON.stringify(e))}),e(t.zlwk.env.modal.element).on("show.uk.modal",function(){var t=e(this);a=angular.element(e("[ng-controller]",t)[0]).scope()})})})}(jQuery,window);