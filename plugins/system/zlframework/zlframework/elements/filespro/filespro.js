/**
 * @package     ZOOlanders
 * @version     3.3.27
 * @author      ZOOlanders - http://zoolanders.com
 * @license     GNU General Public License v2 or later
 */

!function(e){var t=function(t){this.options=e.extend({},this.options,t),this.events={}};t.prototype=e.extend(t.prototype,e.zlux.Main.prototype,{name:"ElementFilespro",options:{root:"",extensions:"",storage:"",fileMode:"",max_file_size:"",title:"",resize:{}},events:{},initialize:function(t,i){this.options=e.extend({},e.zlux.Main.prototype.options,this.options,i);var a=this;a.element=t,t.on("click","p.add a",function(){a.apply(e("input.filespro",t).add("input.mediapro-element",t))}),a.apply(e("input.filespro",t).add("input.mediapro-element",t))},apply:function(t){var i=this;e.zlux.assets.load("files").done(function(){var a=e.zlux.filesPreview();t.each(function(t,o){var n=e(o);if(!e(o).data("initialized")){var l="filespro-element-"+t,r=n.closest(".row").addClass("zl-bootstrap"),s=!!n.hasClass("image-element");n.attr("id",l);var p=e("span.zlux-x-filedata",r).data("zlux-storage");i.dialogTrigger=e('<a title="'+i.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').appendTo(r),i.dialogTrigger.zlux("filesDialogManager",{extensions:i.options.extensions,max_file_size:i.options.max_file_size,title:i.options.title,storage:p.engine,storage_params:p,root:p.root,resize:i.options.resize}).on("zlux.ObjectSelected",function(t,o,l){if(!("files"==i.options.fileMode&&"file"!=l.type||"folders"==i.options.fileMode&&"folder"!=l.type)){var p=o.getFullPath(l.name);n.val(p).trigger("change"),l.path=p,e(".zlux-preview",r).remove(),r.append(a.renderPreviewDOM(l,s))}});var d=e("span.zlux-x-filedata",r).data("zlux-data");!e.isEmptyObject(d)&&n.val()&&(d.path=n.val(),r.append(a.renderPreviewDOM(d,s))),e('<i class="icon-remove zlux-x-cancel-btn" />').insertAfter(n).on("click",function(){n.val(""),e(".zlux-preview",r).remove()})}n.data("initialized",!0)})})}}),e.fn[t.prototype.name]=function(){var i=arguments,a=i[0]?i[0]:null;return this.each(function(){var o=e(this);if(t.prototype[a]&&o.data(t.prototype.name)&&"initialize"!=a)o.data(t.prototype.name)[a].apply(o.data(t.prototype.name),Array.prototype.slice.call(i,1));else if(!a||e.isPlainObject(a)){var n=new t;t.prototype.initialize&&n.initialize.apply(n,e.merge([o],i)),o.data(t.prototype.name,n)}else e.error("Method "+a+" does not exist on jQuery."+t.name)})}}(jQuery);