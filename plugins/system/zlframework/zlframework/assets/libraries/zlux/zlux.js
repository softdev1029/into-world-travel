/**
 * @package     ZOOlanders
 * @version     3.3.27
 * @author      ZOOlanders - http://zoolanders.com
 * @license     GNU General Public License v2 or later
 */

!function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"zluxSaveElement",options:{url:"",msgSaveElement:"Save Element"},initialize:function(e,i){this.options=t.extend({},this.options,i);var o=this;t('<a class="btn btn-small save" href="javascript:void(0);"><i class="icon-ok-sign"></i> '+o.options.msgSaveElement+"</a>").on("click",function(){var e=t(this).addClass("btn-working"),i=e.closest(".element").find("input, textarea").serializeArray();t.post(o.options.url+"&task=saveelement",i,function(t){e.removeClass("btn-working")})}).appendTo(e.find(".btn-toolbar"))}}),t.fn[e.prototype.name]=function(){var i=arguments,o=i[0]?i[0]:null;return this.each(function(){var n=t(this);if(e.prototype[o]&&n.data(e.prototype.name)&&"initialize"!=o)n.data(e.prototype.name)[o].apply(n.data(e.prototype.name),Array.prototype.slice.call(i,1));else if(!o||t.isPlainObject(o)){var a=new e;e.prototype.initialize&&a.initialize.apply(a,t.merge([n],i)),n.data(e.prototype.name,a)}else t.error("Method "+o+" does not exist on jQuery."+e.name)})}}(jQuery),function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"zluxBrowseFile",options:{url:"",path:"images"},initialize:function(e,i){this.options=t.extend({},this.options,i);var o=this,n=location.href.match(/^(.+)administrator\/index\.php.*/i)[1];e.wrap('<div class="zlux-finder"><div /></div>').zluxDialog({title:"Dialog title",width:600,height:400,classes:"zlux-finder"},function(i){i.content.zluxFinder({dialog:i,url:o.options.url,path:o.options.path}),i.content.on("click",".item.file a",function(){e.val(t(this).closest(".item").data("path"))&&e.trigger("change")})});var a=t('<div class="file-preview zl-bootstrap" />').append(t('<img class="img-polaroid" />')).appendTo(e.parent());e.on("change",function(){a.find("img").attr("src",n+e.val())}).trigger("change"),t("<span>").addClass("input-cancel").insertAfter(e).click(function(){e.val("")})}}),t.fn[e.prototype.name]=function(){var i=arguments,o=i[0]?i[0]:null;return this.each(function(){var n=t(this);if(e.prototype[o]&&n.data(e.prototype.name)&&"initialize"!=o)n.data(e.prototype.name)[o].apply(n.data(e.prototype.name),Array.prototype.slice.call(i,1));else if(!o||t.isPlainObject(o)){var a=new e;e.prototype.initialize&&a.initialize.apply(a,t.merge([n],i)),n.data(e.prototype.name,a)}else t.error("Method "+o+" does not exist on jQuery."+e.name)})}}(jQuery),function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"zluxFinder",options:{dialog:{},url:"",path:"images",open:"open",filemanager:!0},initialize:function(e,i){function o(i){i.preventDefault();var s=t(this).closest(".zlux-dialog li",e);s.length||(s=e),s.hasClass("file")||(s.hasClass(l)&&!s.hasClass("reload")?s.removeClass(l).children("ul").slideUp():(s.addClass("loading"),t.post(n.options.url+"&controller=zlframework&task=JSONfiles",{path:s.data("path")},function(i){s.removeClass("loading").addClass(l),n.options.dialog.loaded(),s.children().remove("ul.items"),!i||i.msg||(n.buildItemsTree(i,s),s.find("ul a").on("click",o).on("click",function(){t(this).closest(".zlux-dialog").find(".selected").removeClass("selected"),t(this).closest(".item").addClass("selected")}),s.children("ul").slideDown(),!s.hasClass("reload")||s.children("ul").length,n.options.filemanager&&(e.data("toolbar-initialized")||(t('<span class="root-folder tools" />').append(t('<span class="zl-btn-small refresh action" title="Refresh" />').bind("click",function(){s.addClass("reload").find("li").addClass("loading"),e.trigger("zluxFinder.retrieve")})).append(t('<span class="zl-btn-small plupload action" title="'+filesPro.translate("Upload files into the main folder")+'" />').bind("click",function(){n.plupload(t(this),"",function(){s.addClass("reload").find("li").addClass("loading"),e.trigger("zluxFinder.retrieve")})})).append(t('<span class="zl-btn-small add action" title="'+filesPro.translate("Create a new folder into the main folder")+'" />').bind("click",function(){n.Prompt(filesPro.translate("Input a name for the new folder"),filesPro.translate("MyFolder"),t(this),function(e){e&&s.find("li").addClass("loading")&&t.post(n.options.url+"&method=newfolder",{path:"",newfolder:e},function(){s.addClass("reload"),a.trigger("zluxFinder.retrieve")},"json")})})).prependTo(e.closest(".ui-dialog").find(".ui-dialog-titlebar")),e.data("toolbar-initialized",!0)),t(".ui-dialog").find(".tools span").qtip({position:{my:"bottom left",at:"top center"},show:{delay:700},style:"ui-tooltip-custom ui-tooltip-light ui-tooltip-rounded ui-tooltip-dialogue"})))},"json")))}this.options=t.extend({},this.options,i);var n=this,l=n.options.open;e.data("path",this.options.path).bind("zluxFinder.retrieve",o).trigger("zluxFinder.retrieve")},buildItemsTree:function(e,i){var o=this;i.append('<ul class="items" />').children("ul").hide(),t.each(e,function(e,n){var a=t('<li class="item" />').addClass(n.type).data("path",n.path).data("size",n.size);o.options.filemanager&&t('<div class="btns"><a href="#">'+n.name+"</a></div>").append(t('<span class="tools" />').append("folder"==n.type&&t('<span class="zl-btn-small plupload action" title="'+filesPro.translate("Upload files into this folder")+'" />').bind("click",function(){var e=t(this);o.plupload(e.closest("li"),n.path,function(){e.closest("li").addClass("reload"),e.closest(".finderpro .btns").find("a").trigger("click")})})).append("folder"==n.type&&t('<span class="zl-btn-small add action" title="'+filesPro.translate("Create a new subfolder")+'" />').bind("click",function(){var e=t(this);o.Prompt(filesPro.translate("Input a name for the new folder"),filesPro.translate("MyFolder"),e.closest("li"),function(i){i&&e.closest("li").addClass("reload loading")&&t.post(o.options.url+"&method=newfolder",{path:n.path,newfolder:i},function(){e.closest(".btns").find("a").trigger("click")},"json")})})).append(t('<span class="zl-btn-small delete action" title="'+filesPro.translate("Delete")+'" />').click(function(){var e=t(this);o.Confirm(filesPro.translate("You are about to delete")+' "'+n.name+'"',e.closest("li"),function(i){i&&e.closest("li").addClass("loading")&&t.post(o.options.url+"&method=delete",{path:n.path},function(){e.closest("li").fadeOut(400,function(){e.closest("li").remove()})},"json")})}))).appendTo(a),a.appendTo(i.children("ul"))})},plupload:function(e,i,o){var n=this,a=t("<div />").appendTo("body").Plupload({url:n.options.url,path:void 0===i?"":i,extensions:n.options.extensions,fileMode:"files",callback:o});t('<a class="plupload_button plupload_cancel ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" />').append(t('<span class="ui-button-icon-primary ui-icon ui-icon-circle-close"></span>')).append(t('<span class="ui-button-text">'+filesPro.translate("Cancel")+"</span>")).bind("hover",function(){t(this).toggleClass("ui-state-hover")}).bind("click",function(){t(this).closest(".qtip").qtip("hide"),n.reset()}).appendTo(a.find(".plupload_buttons")),this.dialogue(a,e,"plupload")},dialogue:function(e,i,o){this.reset(),i.find(".btns").first().addClass("action"),t(i).qtip({content:{text:e},position:{my:"left bottom",at:"top right",viewport:t(window)},show:{ready:!0,solo:!0,delay:0},hide:!1,style:o+" ui-tooltip-custom ui-tooltip-filespro ui-tooltip-light ui-tooltip-rounded ui-tooltip-dialogue",events:{render:function(e,i){t("button",i.elements.content).click(i.hide)},hide:function(t,e){e.destroy()}}})},Confirm:function(e,i,o){var n=t("<p />",{text:e}),a=t("<button />",{text:filesPro.translate("Confirm"),click:function(){o(!0),i.closest(".finderpro").find(".btns").removeClass("action")}}),l=t("<button />",{text:filesPro.translate("Cancel"),click:function(){o(!1),i.closest(".finderpro").find(".btns").removeClass("action")}});this.dialogue(n.add(a).add(l),i)},Prompt:function(e,i,o,n){var a=t("<p />",{text:e}),l=t("<input />",{val:i}),s=t("<button />",{text:filesPro.translate("Confirm"),click:function(){n(l.val()),o.closest(".finderpro").find(".btns").removeClass("action")}}),r=t("<button />",{text:filesPro.translate("Cancel"),click:function(){n(null),o.closest(".finderpro").find(".btns").removeClass("action")}});this.dialogue(a.add(l).add(s).add(r),o)},reset:function(){t(".finderpro").find(".btns").removeClass("action"),t(".qtip").qtip("hide")}}),t.fn[e.prototype.name]=function(){var i=arguments,o=i[0]?i[0]:null;return this.each(function(){var n=t(this);if(e.prototype[o]&&n.data(e.prototype.name)&&"initialize"!=o)n.data(e.prototype.name)[o].apply(n.data(e.prototype.name),Array.prototype.slice.call(i,1));else if(!o||t.isPlainObject(o)){var a=new e;e.prototype.initialize&&a.initialize.apply(a,t.merge([n],i)),n.data(e.prototype.name,a)}else t.error("Method "+o+" does not exist on jQuery."+e.name)})}}(jQuery),function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"zluxDialog",options:{width:"300",height:"150",title:"Dialog",classes:""},initialize:function(e,i,o){this.options=t.extend({},this.options,i);var n=this;this.content=t('<div><span class="zlux-loader-horiz" /></div>').insertAfter(e);var n=this,a=n.content.dialog(t.extend({autoOpen:!1,resizable:!1,width:n.options.width,height:n.options.height,dialogClass:"zlux-dialog zl-bootstrap"+(n.options.classes?" "+n.options.classes:""),open:function(){a.position({of:l,my:"left top",at:"right bottom"})},dragStop:function(e,i){window.qtip&&t(".qtip").qtip("reposition")},close:function(e,i){window.qtip&&t(".qtip").qtip("hide")}},n.options)).dialog("widget"),l=t('<span title="'+n.options.title+'" class="files" />').insertAfter(e).bind("click",function(){n.content.dialog(n.content.dialog("isOpen")?"close":"open"),t(this).data("initialized")||o(n),t(this).data("initialized",!0)});t("html").bind("mousedown",function(e){n.content.dialog("isOpen")&&!l.is(e.target)&&!a.find(e.target).length&&!t(e.target).closest(".qtip").length&&n.content.dialog("close")})},loaded:function(){this.content.find(".zlux-loader-horiz").remove()},close:function(){this.content.dialog("close")}}),t.fn[e.prototype.name]=function(){var i=arguments,o=i[0]?i[0]:null;return this.each(function(){var n=t(this);if(e.prototype[o]&&n.data(e.prototype.name)&&"initialize"!=o)n.data(e.prototype.name)[o].apply(n.data(e.prototype.name),Array.prototype.slice.call(i,1));else if(!o||t.isPlainObject(o)){var a=new e;e.prototype.initialize&&a.initialize.apply(a,t.merge([n],i)),n.data(e.prototype.name,a)}else t.error("Method "+o+" does not exist on jQuery."+e.name)})}}(jQuery);